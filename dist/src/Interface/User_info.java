/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package Interface;

import Classes.Connect;
import java.awt.Color;
import java.awt.Image;
import java.awt.Toolkit;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import javax.swing.Icon;
import javax.swing.ImageIcon;
import javax.swing.WindowConstants;
import java.sql.*;
import javax.swing.JOptionPane;
import java.awt.*; 
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.*;

public class User_info extends javax.swing.JFrame {

   String user;
   String user_inf;
   String user_updated="";
 
   
    public User_info() {
        initComponents();
        
        setSize(630,453);
        setResizable(true);
        this.setLocationRelativeTo(null);
        user=Logo.user;
        user_updated=Manage_User.user_updated;
        setTitle("Information of :" + user_updated + " - " +"Session of :" +user);
        setDefaultCloseOperation(WindowConstants.DISPOSE_ON_CLOSE);   
        ImageIcon wallpaper= new ImageIcon("src/images/wallpaperPrincipal.jpg");
        Icon ic=new ImageIcon(wallpaper.getImage().getScaledInstance(jLabel_wallpaper.getWidth(), jLabel_wallpaper.getHeight(),Image.SCALE_DEFAULT));
        jLabel_wallpaper.setIcon(ic);
        this.repaint();
        
        try{
            
            Connection cn=Connect.Cnnct();
            PreparedStatement ps=cn.prepareStatement("select nombre_usuario from usuarios where username='" + user_updated +"'");
            ResultSet rs=ps.executeQuery();
            
            if(rs.next()){
                user_inf=rs.getString("nombre_usuario");
                jl_inf.setText("USER :" + user_inf+ " INFORMATION" );
                
            }
           
        }
        
        catch(Exception e){
            System.out.println("Not data found please enter a valid user");
        }
      
            jt_name.setBackground(Color.green);
            jt_email.setBackground(Color.green);
            jt_un.setBackground(Color.green);
            jt_tel.setBackground(Color.green);
            jt_sb.setBackground(Color.green);
        
        try{
            Connection cn=Connect.Cnnct();
            PreparedStatement ps=cn.prepareStatement("select * from usuarios where username='" + user_updated +"'");
            ResultSet rs=ps.executeQuery();
            if(rs.next()){
            jt_name.setText(rs.getString("nombre_usuario"));
            jt_email.setText(rs.getString("email"));
            jt_un.setText(rs.getString("username"));
            jt_tel.setText(rs.getString("telefono"));
            jt_sb.setText(rs.getString("registrado_por"));
            jc_perm.setSelectedItem(rs.getString("tipo_nivel"));
            jc_est.setSelectedItem(rs.getString("estatus"));
            }
             cn.close();
        }
        catch(SQLException e){
            JOptionPane.showMessageDialog(null, "Select incomplete please try again");
        }
        
        addWindowListener(new WindowAdapter() {
        @Override
        public void windowClosing(WindowEvent e) {
            User_info.this.dispose();
        }
        });
 
    }
    @Override
    public Image getIconImage(){
    
    Image retValue= Toolkit.getDefaultToolkit().getImage(ClassLoader.getSystemResource("images/icon.png"));
    return retValue;        
    }
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jl_inf = new javax.swing.JLabel();
        jlabel_name = new javax.swing.JLabel();
        jlabel_email = new javax.swing.JLabel();
        jlabel_tel = new javax.swing.JLabel();
        jlabel_perm = new javax.swing.JLabel();
        jlabel_username = new javax.swing.JLabel();
        jlabel_status = new javax.swing.JLabel();
        jlabel_name6 = new javax.swing.JLabel();
        jt_name = new javax.swing.JTextField();
        jt_un = new javax.swing.JTextField();
        jc_est = new javax.swing.JComboBox<>();
        jt_email = new javax.swing.JTextField();
        jt_tel = new javax.swing.JTextField();
        jt_sb = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        jc_perm = new javax.swing.JComboBox<>();
        jButton2 = new javax.swing.JButton();
        jLabel_wallpaper = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setIconImage(getIconImage());
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jl_inf.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jl_inf.setForeground(new java.awt.Color(255, 255, 255));
        getContentPane().add(jl_inf, new org.netbeans.lib.awtextra.AbsoluteConstraints(190, 30, 290, 30));

        jlabel_name.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jlabel_name.setForeground(new java.awt.Color(255, 255, 255));
        jlabel_name.setText("NAME:");
        getContentPane().add(jlabel_name, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 90, 50, -1));

        jlabel_email.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jlabel_email.setForeground(new java.awt.Color(255, 255, 255));
        jlabel_email.setText("E@MAIL:");
        getContentPane().add(jlabel_email, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 140, 60, -1));

        jlabel_tel.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jlabel_tel.setForeground(new java.awt.Color(255, 255, 255));
        jlabel_tel.setText("TELEPHONE:");
        getContentPane().add(jlabel_tel, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 190, 80, -1));

        jlabel_perm.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jlabel_perm.setForeground(new java.awt.Color(255, 255, 255));
        jlabel_perm.setText("PERMIT BY:");
        getContentPane().add(jlabel_perm, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 240, 80, -1));

        jlabel_username.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jlabel_username.setForeground(new java.awt.Color(255, 255, 255));
        jlabel_username.setText("USERNAME:");
        getContentPane().add(jlabel_username, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 90, 80, -1));

        jlabel_status.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jlabel_status.setForeground(new java.awt.Color(255, 255, 255));
        jlabel_status.setText("STATUS:");
        getContentPane().add(jlabel_status, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 140, 70, -1));

        jlabel_name6.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jlabel_name6.setForeground(new java.awt.Color(255, 255, 255));
        jlabel_name6.setText("SIGNED UP BY:");
        getContentPane().add(jlabel_name6, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 190, 100, 20));
        getContentPane().add(jt_name, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 110, 210, -1));

        jt_un.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jt_unActionPerformed(evt);
            }
        });
        getContentPane().add(jt_un, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 110, 210, -1));

        jc_est.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Active", "Inactive" }));
        getContentPane().add(jc_est, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 160, -1, -1));

        jt_email.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jt_emailActionPerformed(evt);
            }
        });
        getContentPane().add(jt_email, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 160, 210, -1));
        getContentPane().add(jt_tel, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 210, 210, -1));

        jt_sb.setBackground(new java.awt.Color(204, 204, 204));
        getContentPane().add(jt_sb, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 210, 210, -1));

        jButton1.setText("UPDATE USER");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 270, 220, -1));

        jc_perm.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Administrator", "Technician", "Taker" }));
        jc_perm.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jc_permActionPerformed(evt);
            }
        });
        getContentPane().add(jc_perm, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 260, 130, -1));

        jButton2.setText("RESTORE PASSWORD");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton2, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 330, 220, -1));
        getContentPane().add(jLabel_wallpaper, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 650, 430));

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jt_unActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jt_unActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jt_unActionPerformed

    private void jt_emailActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jt_emailActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jt_emailActionPerformed

    private void jc_permActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jc_permActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jc_permActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
         int perm_cmb;
         String perm_string="";
         int status;
         String status_String="";
         int number_attempts=0;
         
         perm_cmb=jc_perm.getSelectedIndex()+1;
         status=jc_est.getSelectedIndex()+1;
         
         if(perm_cmb==1){
          perm_string="Administrador";
        } else if(perm_cmb==2){
          perm_string="Taker";  
        } else if(perm_cmb==3){
          perm_string="Technician";  
        }
         
         
        if(status==1){
            status_String="Active";
         }else if(status==2){
             status_String="Inactive";
         }
        
         if((jt_name.getText().trim()).equals("")){
            jt_name.setBackground(Color.red);
            number_attempts++;
        }
        if((jt_email.getText().trim()).equals("")){
            jt_email.setBackground(Color.red);
            number_attempts++;
        }
        if((jt_un.getText().trim()).equals("")){
            jt_un.setBackground(Color.red);
            number_attempts++;
        }
        if((jt_tel.getText().trim()).equals("")){
            jt_tel.setBackground(Color.red);
            number_attempts++;
        }
        if((jt_sb.getText().trim()).equals("")){
            jt_sb.setBackground(Color.red);
            number_attempts++;
        }
        
        if(number_attempts==0){
          try{
            Connection cn=Connect.Cnnct();
            PreparedStatement ps=cn.prepareStatement("update usuarios set nombre_usuario=?,email=?,username=?,telefono=?,registrado_por=?,tipo_nivel=?,estatus=? where username='" + user_updated +"'");
            ps.setString(1, jt_name.getText().trim());
            ps.setString(2, jt_email.getText().trim());
            ps.setString(3, jt_un.getText().trim());
            ps.setString(4, jt_tel.getText().trim());
            ps.setString(5, jt_sb.getText().trim());
            ps.setString(6,perm_string );
            ps.setString(7, status_String);
            ps.executeUpdate();
             
            jt_name.setBackground(Color.green);
            jt_email.setBackground(Color.green);
            jt_un.setBackground(Color.green);
            jt_tel.setBackground(Color.green);
            jt_sb.setBackground(Color.green);
             JOptionPane.showMessageDialog(null, "Successful updated!");
          dispose();             
          }
          catch(SQLException e){
            JOptionPane.showMessageDialog(null, "Select incomplete please try again");
          }
        }
        else{
            
            JOptionPane.showMessageDialog(null, "Field/s incompleted please try to fill out it/them");
        
        }
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        new change_password().setVisible(true);
    }//GEN-LAST:event_jButton2ActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(User_info.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(User_info.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(User_info.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(User_info.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new User_info().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel_wallpaper;
    private javax.swing.JComboBox<String> jc_est;
    private javax.swing.JComboBox<String> jc_perm;
    private javax.swing.JLabel jl_inf;
    private javax.swing.JLabel jlabel_email;
    private javax.swing.JLabel jlabel_name;
    private javax.swing.JLabel jlabel_name6;
    private javax.swing.JLabel jlabel_perm;
    private javax.swing.JLabel jlabel_status;
    private javax.swing.JLabel jlabel_tel;
    private javax.swing.JLabel jlabel_username;
    private javax.swing.JTextField jt_email;
    private javax.swing.JTextField jt_name;
    private javax.swing.JTextField jt_sb;
    private javax.swing.JTextField jt_tel;
    private javax.swing.JTextField jt_un;
    // End of variables declaration//GEN-END:variables
}
